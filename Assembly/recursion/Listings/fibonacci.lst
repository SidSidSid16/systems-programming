


ARM Macro Assembler    Page 1 


    1 00000000                 AREA             mainarea,CODE
    2 00000000                 EXPORT           fib
    3 00000000         
    4 00000000         fib
    5 00000000 B502            PUSH             {r1, LR}
    6 00000002         ; check for the base case if r0 is 1 or 2
    7 00000002 2801            CMP              r0, #1
    8 00000004 D010            BEQ              base_case
    9 00000006 2802            CMP              r0, #2
   10 00000008 D00E            BEQ              base_case
   11 0000000A         
   12 0000000A         ; recursive fib(n-1)
   13 0000000A B401            PUSH             {r0}        ; save r0 so that w
                                                            hen n-1 completes, 
                                                            we can do n-2.
   14 0000000C F1A0 0001       SUB              r0, r0, #1  ; calculate the n-1
                                                             index.
   15 00000010 F7FF FFFE       BL               fib         ; branch back to fi
                                                            b, recursively calc
                                                             fib(n-1).
   16 00000014         ; we want to return to this line after we recursively
   17 00000014         ; calculated fib(n-1).
   18 00000014 4601            MOV              r1, r0      ; save output of fi
                                                            b(n-1) in r1.
   19 00000016         
   20 00000016         ; recursive fib(n-2)
   21 00000016 BC01            POP              {r0}        ; restore r0 to cal
                                                            culate fib(n-2) for
                                                             original index.
   22 00000018 F1A0 0002       SUB              r0, r0, #2  ; calculate the n-2
                                                             index.
   23 0000001C F7FF FFFE       BL               fib         ; branch back to fi
                                                            b, recursively calc
                                                             fib(n-1) for n-2 v
                                                            alue.
   24 00000020         ; we want to return to this line after we recurively
   25 00000020         ; calculated fib(n-1) for n = requested index - 2.
   26 00000020         ; at this point, we'd have calculated both fib(n-1) and 
                       fib(n-2).
   27 00000020         
   28 00000020 4408            ADD              r0, r0, r1  ; add the two fib c
                                                            alcs for n-1 and n-
                                                            2 - this is the res
                                                            ult.
   29 00000022         
   30 00000022 E8BD 4002       POP              {r1, LR}
   31 00000026 4770            BX               LR
   32 00000028         
   33 00000028         
   34 00000028         base_case
   35 00000028 F04F 0001       MOV              r0, #1
   36 0000002C E8BD 4002       POP              {r1, LR}
   37 00000030 4770            BX               LR
   38 00000032         
   39 00000032                 END
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4.fp.sp --depen
d=.\objects\fibonacci.d -o.\objects\fibonacci.o -I.\RTE\_STM32F407_Flash -IC:\K
EIL_V5\ARM\PACK\ARM\CMSIS\5.8.0\CMSIS\Core\Include -IC:\KEIL_V5\ARM\PACK\Keil\S
TM32F4xx_DFP\2.15.0\Drivers\CMSIS\Device\ST\STM32F4xx\Include --predefine="__UV



ARM Macro Assembler    Page 2 


ISION_VERSION SETA 535" --predefine="_RTE_ SETA 1" --predefine="STM32F407xx SET
A 1" --predefine="_RTE_ SETA 1" --list=.\listings\fibonacci.lst asm\fibonacci.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

base_case 00000028

Symbol: base_case
   Definitions
      At line 34 in file asm\fibonacci.s
   Uses
      At line 8 in file asm\fibonacci.s
      At line 10 in file asm\fibonacci.s

fib 00000000

Symbol: fib
   Definitions
      At line 4 in file asm\fibonacci.s
   Uses
      At line 2 in file asm\fibonacci.s
      At line 15 in file asm\fibonacci.s
      At line 23 in file asm\fibonacci.s

mainarea 00000000

Symbol: mainarea
   Definitions
      At line 1 in file asm\fibonacci.s
   Uses
      None
Comment: mainarea unused
3 symbols
337 symbols in table
